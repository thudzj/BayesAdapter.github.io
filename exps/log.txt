'''
    onelayer-emp-u-3-fvar-alpha1-th.5-mineps.5
    Parallel ensemble 20 TOP1: 75.7960, TOP5: 92.6500, LOS: 1.0295, ECE: 0.0644
    NAT vs. FGSM --> AP: 0.9997; TPR: 0.9993 @ FPR=0.0100; TPR: 1.0000 @ FPR=0.0500; TPR: 1.0000 @ FPR=0.1000
    NAT vs. BIM --> AP: 0.9786; TPR: 0.6574 @ FPR=0.0100; TPR: 0.8767 @ FPR=0.0500; TPR: 0.9564 @ FPR=0.1000
    NAT vs. PGD --> AP: 0.9967; TPR: 0.9369 @ FPR=0.0100; TPR: 0.9884 @ FPR=0.0500; TPR: 0.9974 @ FPR=0.1000
    NAT vs. MIM --> AP: 0.9937; TPR: 0.8726 @ FPR=0.0100; TPR: 0.9733 @ FPR=0.0500; TPR: 0.9939 @ FPR=0.1000
    NAT vs. TIM --> AP: 0.9789; TPR: 0.6430 @ FPR=0.0100; TPR: 0.8840 @ FPR=0.0500; TPR: 0.9651 @ FPR=0.1000
    NAT vs. FGSM_L2 --> AP: 0.9894; TPR: 0.8254 @ FPR=0.0100; TPR: 0.9562 @ FPR=0.0500; TPR: 0.9852 @ FPR=0.1000
    NAT vs. BIM_L2 --> AP: 0.9776; TPR: 0.6397 @ FPR=0.0100; TPR: 0.8734 @ FPR=0.0500; TPR: 0.9567 @ FPR=0.1000
    NAT vs. PGD_L2 --> AP: 0.9961; TPR: 0.9232 @ FPR=0.0100; TPR: 0.9854 @ FPR=0.0500; TPR: 0.9957 @ FPR=0.1000
    NAT vs. PGD_transferred from resnet152 --> AP: 0.9992; TPR: 0.9962 @ FPR=0.0100; TPR: 0.9994 @ FPR=0.0500; TPR: 0.9999 @ FPR=0.1000
    NAT vs. MIM_transferred from resnet152 --> AP: 0.9990; TPR: 0.9882 @ FPR=0.0100; TPR: 0.9975 @ FPR=0.0500; TPR: 0.9993 @ FPR=0.1000
    NAT vs. TIM_transferred from resnet152 --> AP: 0.9180; TPR: 0.2986 @ FPR=0.0100; TPR: 0.5883 @ FPR=0.0500; TPR: 0.7753 @ FPR=0.1000


    CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id onelayer-emp-u-5-fvar-alpha1-th.5-mineps.5-maxeps2-sharpen.2.5 --num_mc_samples 20 --posterior_type emp --epochs 5 --alpha 1 --uncertainty_threshold 0.5 --epsilon_min_train 0.5 --lr 0.001 --blur_prob 0 --epsilon_max_train 2 --sharpen_prob 0.2 --sharpen_param 0.5
    Parallel ensemble 20 TOP1: 75.9140, TOP5: 92.7920, LOS: 1.0170, ECE: 0.0669
    NAT vs. FGSM --> AP: 0.9999; TPR: 0.9997 @ FPR=0.0100; TPR: 0.9999 @ FPR=0.0500; TPR: 1.0000 @ FPR=0.1000
    NAT vs. BIM --> AP: 0.9915; TPR: 0.8501 @ FPR=0.0100; TPR: 0.9662 @ FPR=0.0500; TPR: 0.9865 @ FPR=0.1000
    NAT vs. PGD --> AP: 0.9974; TPR: 0.9569 @ FPR=0.0100; TPR: 0.9936 @ FPR=0.0500; TPR: 0.9974 @ FPR=0.1000
    NAT vs. MIM --> AP: 0.9976; TPR: 0.9578 @ FPR=0.0100; TPR: 0.9953 @ FPR=0.0500; TPR: 0.9988 @ FPR=0.1000
    NAT vs. TIM --> AP: 0.9914; TPR: 0.8413 @ FPR=0.0100; TPR: 0.9708 @ FPR=0.0500; TPR: 0.9886 @ FPR=0.1000
    NAT vs. FGSM_L2 --> AP: 0.9906; TPR: 0.8539 @ FPR=0.0100; TPR: 0.9662 @ FPR=0.0500; TPR: 0.9850 @ FPR=0.1000
    NAT vs. BIM_L2 --> AP: 0.9919; TPR: 0.8547 @ FPR=0.0100; TPR: 0.9699 @ FPR=0.0500; TPR: 0.9881 @ FPR=0.1000
    NAT vs. PGD_L2 --> AP: 0.9971; TPR: 0.9514 @ FPR=0.0100; TPR: 0.9922 @ FPR=0.0500; TPR: 0.9970 @ FPR=0.1000
    NAT vs. PGD_transferred from resnet152 --> AP: 0.9994; TPR: 0.9958 @ FPR=0.0100; TPR: 0.9990 @ FPR=0.0500; TPR: 0.9994 @ FPR=0.1000
    NAT vs. MIM_transferred from resnet152 --> AP: 0.9991; TPR: 0.9872 @ FPR=0.0100; TPR: 0.9972 @ FPR=0.0500; TPR: 0.9987 @ FPR=0.1000
    NAT vs. TIM_transferred from resnet152 --> AP: 0.9216; TPR: 0.3421 @ FPR=0.0100; TPR: 0.6550 @ FPR=0.0500; TPR: 0.7908 @ FPR=0.1000


    CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id onelayer-emp-u-5-fvar-alpha1-th.5-mineps.5-maxeps2 --num_mc_samples 20 --posterior_type emp --epochs 5 --alpha 1 --uncertainty_threshold 0.5 --epsilon_min_train 0.5 --lr 0.001 --blur_prob 0 --epsilon_max_train 2
    Parallel ensemble 20 TOP1: 76.0480, TOP5: 92.8920, LOS: 1.0239, ECE: 0.0690
    NAT vs. FGSM --> AP: 0.9999; TPR: 0.9999 @ FPR=0.0100; TPR: 1.0000 @ FPR=0.0500; TPR: 1.0000 @ FPR=0.1000
    NAT vs. BIM --> AP: 0.9899; TPR: 0.8112 @ FPR=0.0100; TPR: 0.9576 @ FPR=0.0500; TPR: 0.9836 @ FPR=0.1000
    NAT vs. PGD --> AP: 0.9971; TPR: 0.9464 @ FPR=0.0100; TPR: 0.9916 @ FPR=0.0500; TPR: 0.9971 @ FPR=0.1000
    NAT vs. MIM --> AP: 0.9974; TPR: 0.9450 @ FPR=0.0100; TPR: 0.9948 @ FPR=0.0500; TPR: 0.9989 @ FPR=0.1000
    NAT vs. TIM --> AP: 0.9898; TPR: 0.7947 @ FPR=0.0100; TPR: 0.9605 @ FPR=0.0500; TPR: 0.9874 @ FPR=0.1000
    NAT vs. FGSM_L2 --> AP: 0.9868; TPR: 0.7944 @ FPR=0.0100; TPR: 0.9446 @ FPR=0.0500; TPR: 0.9752 @ FPR=0.1000
    NAT vs. BIM_L2 --> AP: 0.9899; TPR: 0.8072 @ FPR=0.0100; TPR: 0.9596 @ FPR=0.0500; TPR: 0.9851 @ FPR=0.1000
    NAT vs. PGD_L2 --> AP: 0.9969; TPR: 0.9384 @ FPR=0.0100; TPR: 0.9916 @ FPR=0.0500; TPR: 0.9971 @ FPR=0.1000
    NAT vs. PGD_transferred from resnet152 --> AP: 0.9995; TPR: 0.9942 @ FPR=0.0100; TPR: 0.9990 @ FPR=0.0500; TPR: 0.9997 @ FPR=0.1000
    NAT vs. MIM_transferred from resnet152 --> AP: 0.9987; TPR: 0.9791 @ FPR=0.0100; TPR: 0.9950 @ FPR=0.0500; TPR: 0.9980 @ FPR=0.1000
    NAT vs. TIM_transferred from resnet152 --> AP: 0.9045; TPR: 0.2739 @ FPR=0.0100; TPR: 0.5889 @ FPR=0.0500; TPR: 0.7472 @ FPR=0.1000


    CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id onelayer-emp-u-4-fvar-alpha1-th.5-mineps1-maxeps2-sharpen0-blur.1 --num_mc_samples 20 --posterior_type emp --epochs 4 --alpha 1 --uncertainty_threshold 0.5 --epsilon_min_train 1 --lr 0.001 --blur_prob 0.1 --epsilon_max_train 2 --sharpen_prob 0 --sharpen_param 0.5 (gpu28)
    Parallel ensemble 20 TOP1: 75.8700, TOP5: 92.8260, LOS: 1.0182, ECE: 0.0635
    NAT vs. FGSM --> AP: 0.9937; TPR: 0.9765 @ FPR=0.0100; TPR: 0.9993 @ FPR=0.0500; TPR: 0.9999 @ FPR=0.1000
    NAT vs. BIM --> AP: 0.9900; TPR: 0.8549 @ FPR=0.0100; TPR: 0.9490 @ FPR=0.0500; TPR: 0.9730 @ FPR=0.1000
    NAT vs. PGD --> AP: 0.9922; TPR: 0.8671 @ FPR=0.0100; TPR: 0.9627 @ FPR=0.0500; TPR: 0.9829 @ FPR=0.1000
    NAT vs. MIM --> AP: 0.9971; TPR: 0.9470 @ FPR=0.0100; TPR: 0.9876 @ FPR=0.0500; TPR: 0.9952 @ FPR=0.1000
    NAT vs. TIM --> AP: 0.9974; TPR: 0.9553 @ FPR=0.0100; TPR: 0.9887 @ FPR=0.0500; TPR: 0.9949 @ FPR=0.1000
    NAT vs. FGSM_L2 --> AP: 0.9937; TPR: 0.9082 @ FPR=0.0100; TPR: 0.9788 @ FPR=0.0500; TPR: 0.9896 @ FPR=0.1000
    NAT vs. BIM_L2 --> AP: 0.9912; TPR: 0.8630 @ FPR=0.0100; TPR: 0.9559 @ FPR=0.0500; TPR: 0.9783 @ FPR=0.1000
    NAT vs. PGD_L2 --> AP: 0.9928; TPR: 0.8784 @ FPR=0.0100; TPR: 0.9667 @ FPR=0.0500; TPR: 0.9850 @ FPR=0.1000
    NAT vs. PGD_transferred from resnet152 --> AP: 0.9941; TPR: 0.9169 @ FPR=0.0100; TPR: 0.9874 @ FPR=0.0500; TPR: 0.9939 @ FPR=0.1000
    NAT vs. MIM_transferred from resnet152 --> AP: 0.9963; TPR: 0.9557 @ FPR=0.0100; TPR: 0.9923 @ FPR=0.0500; TPR: 0.9962 @ FPR=0.1000
    NAT vs. TIM_transferred from resnet152 --> AP: 0.9978; TPR: 0.9699 @ FPR=0.0100; TPR: 0.9905 @ FPR=0.0500; TPR: 0.9948 @ FPR=0.1000


    CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id onelayer-mfg-u-4-fvar-alpha1-th.5-mineps1-maxeps2-sharpen0-blur.1 --num_mc_samples 20 --posterior_type mfg --epochs 4 --alpha 1 --uncertainty_threshold 0.5 --epsilon_min_train 1 --lr 0.001 --blur_prob 0.1 --epsilon_max_train 2 --sharpen_prob 0 --sharpen_param 0.5 (gpu28)
    Parallel ensemble 20 TOP1: 75.8920, TOP5: 92.7380, LOS: 1.0004, ECE: 0.0527
    NAT vs. FGSM --> AP: 0.8188; TPR: 0.0002 @ FPR=0.0100; TPR: 0.1030 @ FPR=0.0500; TPR: 0.9357 @ FPR=0.1000
    NAT vs. BIM --> AP: 0.9592; TPR: 0.6581 @ FPR=0.0100; TPR: 0.7452 @ FPR=0.0500; TPR: 0.8034 @ FPR=0.1000
    NAT vs. PGD --> AP: 0.9760; TPR: 0.7629 @ FPR=0.0100; TPR: 0.8614 @ FPR=0.0500; TPR: 0.9000 @ FPR=0.1000
    NAT vs. MIM --> AP: 0.9835; TPR: 0.8279 @ FPR=0.0100; TPR: 0.8823 @ FPR=0.0500; TPR: 0.9156 @ FPR=0.1000
    NAT vs. TIM --> AP: 0.9835; TPR: 0.8162 @ FPR=0.0100; TPR: 0.8825 @ FPR=0.0500; TPR: 0.9185 @ FPR=0.1000
    NAT vs. FGSM_L2 --> AP: 0.8491; TPR: 0.0178 @ FPR=0.0100; TPR: 0.3510 @ FPR=0.0500; TPR: 0.8537 @ FPR=0.1000
    NAT vs. BIM_L2 --> AP: 0.9609; TPR: 0.6508 @ FPR=0.0100; TPR: 0.7470 @ FPR=0.0500; TPR: 0.8137 @ FPR=0.1000
    NAT vs. PGD_L2 --> AP: 0.9789; TPR: 0.7635 @ FPR=0.0100; TPR: 0.8679 @ FPR=0.0500; TPR: 0.9125 @ FPR=0.1000
    NAT vs. PGD_transferred from resnet152 --> AP: 0.8665; TPR: 0.0171 @ FPR=0.0100; TPR: 0.4066 @ FPR=0.0500; TPR: 0.9219 @ FPR=0.1000
    NAT vs. MIM_transferred from resnet152 --> AP: 0.8663; TPR: 0.0213 @ FPR=0.0100; TPR: 0.3712 @ FPR=0.0500; TPR: 0.9372 @ FPR=0.1000
    NAT vs. TIM_transferred from resnet152 --> AP: 0.8952; TPR: 0.0468 @ FPR=0.0100; TPR: 0.5410 @ FPR=0.0500; TPR: 0.9536 @ FPR=0.1000


    CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id onelayer-emp-u-4-fvar-alpha1-th.5-mineps1-maxeps2-sharpen0-blur.05 --num_mc_samples 20 --posterior_type emp --epochs 4 --alpha 1 --uncertainty_threshold 0.5 --epsilon_min_train 1 --lr 0.001 --blur_prob 0.05 --epsilon_max_train 2 --sharpen_prob 0 --sharpen_param 0.5
    Parallel ensemble 20 TOP1: 75.7960, TOP5: 92.7700, LOS: 1.0118, ECE: 0.0609
    NAT vs. FGSM --> AP: 0.9972; TPR: 0.9953 @ FPR=0.0100; TPR: 0.9997 @ FPR=0.0500; TPR: 1.0000 @ FPR=0.1000
    NAT vs. BIM --> AP: 0.9860; TPR: 0.7868 @ FPR=0.0100; TPR: 0.9189 @ FPR=0.0500; TPR: 0.9614 @ FPR=0.1000
    NAT vs. PGD --> AP: 0.9928; TPR: 0.8716 @ FPR=0.0100; TPR: 0.9624 @ FPR=0.0500; TPR: 0.9850 @ FPR=0.1000
    NAT vs. MIM --> AP: 0.9971; TPR: 0.9399 @ FPR=0.0100; TPR: 0.9869 @ FPR=0.0500; TPR: 0.9956 @ FPR=0.1000
    NAT vs. TIM --> AP: 0.9971; TPR: 0.9445 @ FPR=0.0100; TPR: 0.9862 @ FPR=0.0500; TPR: 0.9949 @ FPR=0.1000
    NAT vs. FGSM_L2 --> AP: 0.9928; TPR: 0.8769 @ FPR=0.0100; TPR: 0.9690 @ FPR=0.0500; TPR: 0.9877 @ FPR=0.1000
    NAT vs. BIM_L2 --> AP: 0.9869; TPR: 0.7961 @ FPR=0.0100; TPR: 0.9245 @ FPR=0.0500; TPR: 0.9649 @ FPR=0.1000
    NAT vs. PGD_L2 --> AP: 0.9927; TPR: 0.8688 @ FPR=0.0100; TPR: 0.9640 @ FPR=0.0500; TPR: 0.9861 @ FPR=0.1000
    NAT vs. PGD_transferred from resnet152 --> AP: 0.9967; TPR: 0.9452 @ FPR=0.0100; TPR: 0.9907 @ FPR=0.0500; TPR: 0.9966 @ FPR=0.1000
    NAT vs. MIM_transferred from resnet152 --> AP: 0.9974; TPR: 0.9625 @ FPR=0.0100; TPR: 0.9914 @ FPR=0.0500; TPR: 0.9964 @ FPR=0.1000
    NAT vs. TIM_transferred from resnet152 --> AP: 0.9961; TPR: 0.9384 @ FPR=0.0100; TPR: 0.9807 @ FPR=0.0500; TPR: 0.9913 @ FPR=0.1000

    CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id onelayer-emp-u-4-fvar-alpha1-th.5-mineps1-maxeps2 --num_mc_samples 20 --posterior_type emp --epochs 4 --alpha 1 --uncertainty_threshold 0.5 --epsilon_min_train 1 --lr 0.001 --blur_prob 0 --epsilon_max_train 2
    Parallel ensemble 20 TOP1: 75.8760, TOP5: 92.7880, LOS: 1.0203, ECE: 0.0654
    NAT vs. FGSM --> AP: 1.0000; TPR: 1.0000 @ FPR=0.0100; TPR: 1.0000 @ FPR=0.0500; TPR: 1.0000 @ FPR=0.1000
    NAT vs. BIM --> AP: 0.9881; TPR: 0.7612 @ FPR=0.0100; TPR: 0.9608 @ FPR=0.0500; TPR: 0.9863 @ FPR=0.1000
    NAT vs. PGD --> AP: 0.9956; TPR: 0.9145 @ FPR=0.0100; TPR: 0.9898 @ FPR=0.0500; TPR: 0.9964 @ FPR=0.1000
    NAT vs. MIM --> AP: 0.9972; TPR: 0.9424 @ FPR=0.0100; TPR: 0.9972 @ FPR=0.0500; TPR: 0.9996 @ FPR=0.1000
    NAT vs. TIM --> AP: 0.9891; TPR: 0.7713 @ FPR=0.0100; TPR: 0.9710 @ FPR=0.0500; TPR: 0.9909 @ FPR=0.1000
    NAT vs. FGSM_L2 --> AP: 0.9916; TPR: 0.8426 @ FPR=0.0100; TPR: 0.9712 @ FPR=0.0500; TPR: 0.9882 @ FPR=0.1000
    NAT vs. BIM_L2 --> AP: 0.9879; TPR: 0.7591 @ FPR=0.0100; TPR: 0.9631 @ FPR=0.0500; TPR: 0.9867 @ FPR=0.1000
    NAT vs. PGD_L2 --> AP: 0.9955; TPR: 0.9155 @ FPR=0.0100; TPR: 0.9900 @ FPR=0.0500; TPR: 0.9962 @ FPR=0.1000
    NAT vs. PGD_transferred from resnet152 --> AP: 0.9983; TPR: 0.9766 @ FPR=0.0100; TPR: 0.9971 @ FPR=0.0500; TPR: 0.9990 @ FPR=0.1000
    NAT vs. MIM_transferred from resnet152 --> AP: 0.9976; TPR: 0.9567 @ FPR=0.0100; TPR: 0.9915 @ FPR=0.0500; TPR: 0.9963 @ FPR=0.1000
    NAT vs. TIM_transferred from resnet152 --> AP: 0.9103; TPR: 0.2672 @ FPR=0.0100; TPR: 0.6236 @ FPR=0.0500; TPR: 0.7743 @ FPR=0.1000
'''



CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_face.py --job-id face --posterior_type emp --data_path /data/zhijie/faces_emore --epsilon_min_train 1 --epsilon_max_train 2 --blur_prob 0 --uncertainty_threshold 1 (gpu16) (or face1)


CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id emp-nores-blur.05 --posterior_type emp --blur_prob 0.05 (gpu28)
Parallel ensemble 20 TOP1: 76.1240, TOP5: 92.9300, LOS: 0.9758, ECE: 0.0463
NAT vs. FGSM --> AP: 0.9999; TPR: 0.9996 @ FPR=0.0100; TPR: 0.9999 @ FPR=0.0500; TPR: 0.9999 @ FPR=0.1000
NAT vs. BIM --> AP: 0.9818; TPR: 0.7297 @ FPR=0.0100; TPR: 0.9377 @ FPR=0.0500; TPR: 0.9717 @ FPR=0.1000
NAT vs. PGD --> AP: 0.9884; TPR: 0.8360 @ FPR=0.0100; TPR: 0.9705 @ FPR=0.0500; TPR: 0.9865 @ FPR=0.1000
NAT vs. MIM --> AP: 0.9931; TPR: 0.8942 @ FPR=0.0100; TPR: 0.9888 @ FPR=0.0500; TPR: 0.9967 @ FPR=0.1000
NAT vs. TIM --> AP: 0.9928; TPR: 0.8909 @ FPR=0.0100; TPR: 0.9887 @ FPR=0.0500; TPR: 0.9963 @ FPR=0.1000
NAT vs. FGSM_L2 --> AP: 0.9961; TPR: 0.9496 @ FPR=0.0100; TPR: 0.9864 @ FPR=0.0500; TPR: 0.9926 @ FPR=0.1000
NAT vs. BIM_L2 --> AP: 0.9817; TPR: 0.7338 @ FPR=0.0100; TPR: 0.9402 @ FPR=0.0500; TPR: 0.9724 @ FPR=0.1000
NAT vs. PGD_L2 --> AP: 0.9881; TPR: 0.8334 @ FPR=0.0100; TPR: 0.9699 @ FPR=0.0500; TPR: 0.9860 @ FPR=0.1000
NAT vs. PGD_transferred from resnet152 --> AP: 0.9991; TPR: 0.9924 @ FPR=0.0100; TPR: 0.9976 @ FPR=0.0500; TPR: 0.9986 @ FPR=0.1000
NAT vs. MIM_transferred from resnet152 --> AP: 0.9992; TPR: 0.9886 @ FPR=0.0100; TPR: 0.9977 @ FPR=0.0500; TPR: 0.9988 @ FPR=0.1000
NAT vs. TIM_transferred from resnet152 --> AP: 0.9936; TPR: 0.9112 @ FPR=0.0100; TPR: 0.9781 @ FPR=0.0500; TPR: 0.9886 @ FPR=0.1000


CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id emp-nores-blur.05-6epoch --posterior_type emp --blur_prob 0.05 --epochs 6 (gpu28)
Parallel ensemble 20 TOP1: 76.2180, TOP5: 92.9320, LOS: 0.9767, ECE: 0.0478
NAT vs. FGSM --> AP: 1.0000; TPR: 0.9996 @ FPR=0.0100; TPR: 0.9999 @ FPR=0.0500; TPR: 1.0000 @ FPR=0.1000
NAT vs. CW --> AP: 0.9662; TPR: 0.5595 @ FPR=0.0100; TPR: 0.8629 @ FPR=0.0500; TPR: 0.9341 @ FPR=0.1000
NAT vs. BIM --> AP: 0.9849; TPR: 0.7902 @ FPR=0.0100; TPR: 0.9405 @ FPR=0.0500; TPR: 0.9705 @ FPR=0.1000
NAT vs. PGD --> AP: 0.9905; TPR: 0.8686 @ FPR=0.0100; TPR: 0.9712 @ FPR=0.0500; TPR: 0.9866 @ FPR=0.1000
NAT vs. MIM --> AP: 0.9951; TPR: 0.9303 @ FPR=0.0100; TPR: 0.9908 @ FPR=0.0500; TPR: 0.9972 @ FPR=0.1000
NAT vs. TIM --> AP: 0.9951; TPR: 0.9282 @ FPR=0.0100; TPR: 0.9895 @ FPR=0.0500; TPR: 0.9967 @ FPR=0.1000
NAT vs. DI_MIM --> AP: 0.9999; TPR: 0.9995 @ FPR=0.0100; TPR: 0.9999 @ FPR=0.0500; TPR: 0.9999 @ FPR=0.1000
NAT vs. FGSM_L2 --> AP: 0.9962; TPR: 0.9516 @ FPR=0.0100; TPR: 0.9852 @ FPR=0.0500; TPR: 0.9917 @ FPR=0.1000
NAT vs. BIM_L2 --> AP: 0.9847; TPR: 0.7928 @ FPR=0.0100; TPR: 0.9432 @ FPR=0.0500; TPR: 0.9716 @ FPR=0.1000
NAT vs. PGD_L2 --> AP: 0.9909; TPR: 0.8768 @ FPR=0.0100; TPR: 0.9732 @ FPR=0.0500; TPR: 0.9880 @ FPR=0.1000
NAT vs. PGD_transferred from resnet152 --> AP: 0.9992; TPR: 0.9921 @ FPR=0.0100; TPR: 0.9977 @ FPR=0.0500; TPR: 0.9986 @ FPR=0.1000
NAT vs. CW_transferred from resnet152 --> AP: 0.9991; TPR: 0.9901 @ FPR=0.0100; TPR: 0.9970 @ FPR=0.0500; TPR: 0.9983 @ FPR=0.1000
NAT vs. MIM_transferred from resnet152 --> AP: 0.9994; TPR: 0.9917 @ FPR=0.0100; TPR: 0.9979 @ FPR=0.0500; TPR: 0.9989 @ FPR=0.1000
NAT vs. TIM_transferred from resnet152 --> AP: 0.9964; TPR: 0.9528 @ FPR=0.0100; TPR: 0.9851 @ FPR=0.0500; TPR: 0.9915 @ FPR=0.1000
NAT vs. DI_MIM_transferred from resnet152 --> AP: 0.9999; TPR: 0.9994 @ FPR=0.0100; TPR: 0.9998 @ FPR=0.0500; TPR: 0.9999 @ FPR=0.1000


CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id emp-nores-blur.05-6epoch-mineps.5 --posterior_type emp --blur_prob 0.05 --epochs 6 --epsilon_min_train 0.5 (gpu28)
Parallel ensemble 20 TOP1: 76.2840, TOP5: 92.9600, LOS: 0.9755, ECE: 0.0478
NAT vs. FGSM --> AP: 0.9994; TPR: 0.9989 @ FPR=0.0100; TPR: 0.9996 @ FPR=0.0500; TPR: 0.9998 @ FPR=0.1000
uNAT vs. CW --> AP: 0.9664; TPR: 0.5613 @ FPR=0.0100; TPR: 0.8711 @ FPR=0.0500; TPR: 0.9412 @ FPR=0.1000
NAT vs. BIM --> AP: 0.9801; TPR: 0.7088 @ FPR=0.0100; TPR: 0.9303 @ FPR=0.0500; TPR: 0.9682 @ FPR=0.1000
NAT vs. PGD --> AP: 0.9869; TPR: 0.8174 @ FPR=0.0100; TPR: 0.9659 @ FPR=0.0500; TPR: 0.9843 @ FPR=0.1000
NAT vs. MIM --> AP: 0.9922; TPR: 0.8763 @ FPR=0.0100; TPR: 0.9864 @ FPR=0.0500; TPR: 0.9953 @ FPR=0.1000
NAT vs. TIM --> AP: 0.9924; TPR: 0.8808 @ FPR=0.0100; TPR: 0.9854 @ FPR=0.0500; TPR: 0.9953 @ FPR=0.1000
NAT vs. DI_MIM --> AP: 0.9987; TPR: 0.9992 @ FPR=0.0100; TPR: 0.9997 @ FPR=0.0500; TPR: 0.9998 @ FPR=0.1000
NAT vs. FGSM_L2 --> AP: 0.9914; TPR: 0.8929 @ FPR=0.0100; TPR: 0.9696 @ FPR=0.0500; TPR: 0.9836 @ FPR=0.1000
NAT vs. BIM_L2 --> AP: 0.9797; TPR: 0.7110 @ FPR=0.0100; TPR: 0.9301 @ FPR=0.0500; TPR: 0.9669 @ FPR=0.1000
NAT vs. PGD_L2 --> AP: 0.9869; TPR: 0.8212 @ FPR=0.0100; TPR: 0.9681 @ FPR=0.0500; TPR: 0.9858 @ FPR=0.1000
NAT vs. CW_transferred from resnet152 --> AP: 0.9989; TPR: 0.9958 @ FPR=0.0100; TPR: 0.9984 @ FPR=0.0500; TPR: 0.9990 @ FPR=0.1000
NAT vs. PGD_transferred from resnet152 --> AP: 0.9990; TPR: 0.9963 @ FPR=0.0100; TPR: 0.9985 @ FPR=0.0500; TPR: 0.9991 @ FPR=0.1000
NAT vs. MIM_transferred from resnet152 --> AP: 0.9992; TPR: 0.9931 @ FPR=0.0100; TPR: 0.9982 @ FPR=0.0500; TPR: 0.9989 @ FPR=0.1000
NAT vs. TIM_transferred from resnet152 --> AP: 0.9928; TPR: 0.9017 @ FPR=0.0100; TPR: 0.9736 @ FPR=0.0500; TPR: 0.9864 @ FPR=0.1000
NAT vs. DI_MIM_transferred from resnet152 --> AP: 0.9990; TPR: 0.9990 @ FPR=0.0100; TPR: 0.9996 @ FPR=0.0500; TPR: 0.9997 @ FPR=0.1000

CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id emp-nores-blur.02-6epoch-mineps.5 --posterior_type emp --blur_prob 0.02 --epochs 6 --epsilon_min_train 0.5 (gpu28)
Parallel ensemble 20 TOP1: 76.1580, TOP5: 92.9620, LOS: 0.9784, ECE: 0.0470
NAT vs. FGSM --> AP: 0.9998; TPR: 0.9995 @ FPR=0.0100; TPR: 0.9999 @ FPR=0.0500; TPR: 0.9999 @ FPR=0.1000
NAT vs. CW --> AP: 0.9717; TPR: 0.6222 @ FPR=0.0100; TPR: 0.9093 @ FPR=0.0500; TPR: 0.9591 @ FPR=0.1000
NAT vs. BIM --> AP: 0.9822; TPR: 0.7584 @ FPR=0.0100; TPR: 0.9386 @ FPR=0.0500; TPR: 0.9698 @ FPR=0.1000
NAT vs. PGD --> AP: 0.9920; TPR: 0.9049 @ FPR=0.0100; TPR: 0.9833 @ FPR=0.0500; TPR: 0.9927 @ FPR=0.1000
NAT vs. MIM --> AP: 0.9942; TPR: 0.9279 @ FPR=0.0100; TPR: 0.9929 @ FPR=0.0500; TPR: 0.9980 @ FPR=0.1000
NAT vs. TIM --> AP: 0.9911; TPR: 0.8713 @ FPR=0.0100; TPR: 0.9828 @ FPR=0.0500; TPR: 0.9939 @ FPR=0.1000
NAT vs. DI_MIM --> AP: 0.9996; TPR: 0.9995 @ FPR=0.0100; TPR: 0.9999 @ FPR=0.0500; TPR: 0.9999 @ FPR=0.1000
NAT vs. FGSM_L2 --> AP: 0.9913; TPR: 0.8854 @ FPR=0.0100; TPR: 0.9713 @ FPR=0.0500; TPR: 0.9864 @ FPR=0.1000
NAT vs. BIM_L2 --> AP: 0.9815; TPR: 0.7523 @ FPR=0.0100; TPR: 0.9375 @ FPR=0.0500; TPR: 0.9690 @ FPR=0.1000
NAT vs. PGD_L2 --> AP: 0.9912; TPR: 0.8945 @ FPR=0.0100; TPR: 0.9809 @ FPR=0.0500; TPR: 0.9915 @ FPR=0.1000
NAT vs. CW_transferred from resnet152 --> AP: 0.9995; TPR: 0.9970 @ FPR=0.0100; TPR: 0.9989 @ FPR=0.0500; TPR: 0.9994 @ FPR=0.1000
NAT vs. PGD_transferred from resnet152 --> AP: 0.9996; TPR: 0.9972 @ FPR=0.0100; TPR: 0.9992 @ FPR=0.0500; TPR: 0.9995 @ FPR=0.1000
NAT vs. MIM_transferred from resnet152 --> AP: 0.9993; TPR: 0.9932 @ FPR=0.0100; TPR: 0.9988 @ FPR=0.0500; TPR: 0.9993 @ FPR=0.1000
NAT vs. TIM_transferred from resnet152 --> AP: 0.9660; TPR: 0.5664 @ FPR=0.0100; TPR: 0.8533 @ FPR=0.0500; TPR: 0.9240 @ FPR=0.1000
NAT vs. DI_MIM_transferred from resnet152 --> AP: 0.9997; TPR: 0.9994 @ FPR=0.0100; TPR: 0.9998 @ FPR=0.0500; TPR: 0.9999 @ FPR=0.1000

CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id emp-nores-blur.03-6epoch-mineps.5-2 --posterior_type emp --blur_prob 0.03 --epochs 6 --epsilon_min_train 0.5 (gpu35)
Parallel ensemble 20 TOP1: 76.1940, TOP5: 92.9840, LOS: 0.9841, ECE: 0.0497
NAT vs. FGSM --> auroc: 0.9999; TPR: 0.9995 @ FPR=0.0100; TPR: 0.9999 @ FPR=0.0500; TPR: 1.0000 @ FPR=0.1000
NAT vs. CW --> auroc: 0.9847; TPR: 0.7131 @ FPR=0.0100; TPR: 0.9380 @ FPR=0.0500; TPR: 0.9735 @ FPR=0.1000
NAT vs. BIM --> auroc: 0.9837; TPR: 0.7364 @ FPR=0.0100; TPR: 0.9298 @ FPR=0.0500; TPR: 0.9671 @ FPR=0.1000
NAT vs. PGD --> auroc: 0.9936; TPR: 0.8895 @ FPR=0.0100; TPR: 0.9814 @ FPR=0.0500; TPR: 0.9921 @ FPR=0.1000
NAT vs. MIM --> auroc: 0.9958; TPR: 0.9188 @ FPR=0.0100; TPR: 0.9908 @ FPR=0.0500; TPR: 0.9970 @ FPR=0.1000
NAT vs. TIM --> auroc: 0.9937; TPR: 0.8674 @ FPR=0.0100; TPR: 0.9826 @ FPR=0.0500; TPR: 0.9944 @ FPR=0.1000
NAT vs. DI_MIM --> auroc: 0.9998; TPR: 0.9996 @ FPR=0.0100; TPR: 0.9999 @ FPR=0.0500; TPR: 0.9999 @ FPR=0.1000
NAT vs. FGSM_L2 --> auroc: 0.9945; TPR: 0.9151 @ FPR=0.0100; TPR: 0.9803 @ FPR=0.0500; TPR: 0.9906 @ FPR=0.1000
NAT vs. BIM_L2 --> auroc: 0.9829; TPR: 0.7248 @ FPR=0.0100; TPR: 0.9282 @ FPR=0.0500; TPR: 0.9650 @ FPR=0.1000
NAT vs. PGD_L2 --> auroc: 0.9934; TPR: 0.8837 @ FPR=0.0100; TPR: 0.9804 @ FPR=0.0500; TPR: 0.9919 @ FPR=0.1000
NAT vs. CW_transferred from resnet152 --> auroc: 0.9996; TPR: 0.9972 @ FPR=0.0100; TPR: 0.9993 @ FPR=0.0500; TPR: 0.9996 @ FPR=0.1000
NAT vs. PGD_transferred from resnet152 --> auroc: 0.9996; TPR: 0.9976 @ FPR=0.0100; TPR: 0.9994 @ FPR=0.0500; TPR: 0.9997 @ FPR=0.1000
NAT vs. MIM_transferred from resnet152 --> auroc: 0.9995; TPR: 0.9938 @ FPR=0.0100; TPR: 0.9987 @ FPR=0.0500; TPR: 0.9994 @ FPR=0.1000
NAT vs. TIM_transferred from resnet152 --> auroc: 0.9824; TPR: 0.7283 @ FPR=0.0100; TPR: 0.9221 @ FPR=0.0500; TPR: 0.9626 @ FPR=0.1000
NAT vs. DI_MIM_transferred from resnet152 --> auroc: 0.9998; TPR: 0.9994 @ FPR=0.0100; TPR: 0.9999 @ FPR=0.0500; TPR: 0.9999 @ FPR=0.1000
NAT vs. spsa --> auroc: 0.9688; TPR: 0.8238 @ FPR=0.0100; TPR: 0.8959 @ FPR=0.0500; TPR: 0.9260 @ FPR=0.1000 (CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python spsa_imagenet.py --save-path /data/zhijie/snapshots_ba/emp-nores-blur.03-6epoch-mineps.5)


abl
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id emp-nores-nou-6epoch --posterior_type emp --blur_prob 0.03 --epochs 6 --epsilon_min_train 0.5 --alpha 0 (gpu35)
Parallel ensemble 20 TOP1: 76.1080, TOP5: 92.9540, LOS: 1.0019, ECE: 0.0580
NAT vs. FGSM --> auroc: 0.1217; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0000 @ FPR=0.0500; TPR: 0.0000 @ FPR=0.1000
NAT vs. CW --> auroc: 0.7445; TPR: 0.1395 @ FPR=0.0100; TPR: 0.2736 @ FPR=0.0500; TPR: 0.3766 @ FPR=0.1000
NAT vs. BIM --> auroc: 0.9873; TPR: 0.8702 @ FPR=0.0100; TPR: 0.9415 @ FPR=0.0500; TPR: 0.9647 @ FPR=0.1000
NAT vs. PGD --> auroc: 0.9555; TPR: 0.6209 @ FPR=0.0100; TPR: 0.7944 @ FPR=0.0500; TPR: 0.8644 @ FPR=0.1000
NAT vs. MIM --> auroc: 0.9930; TPR: 0.8927 @ FPR=0.0100; TPR: 0.9652 @ FPR=0.0500; TPR: 0.9831 @ FPR=0.1000
NAT vs. TIM --> auroc: 0.9944; TPR: 0.9018 @ FPR=0.0100; TPR: 0.9738 @ FPR=0.0500; TPR: 0.9884 @ FPR=0.1000
NAT vs. DI_MIM --> auroc: 0.1744; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0000 @ FPR=0.0500; TPR: 0.0000 @ FPR=0.1000
NAT vs. FGSM_L2 --> auroc: 0.2891; TPR: 0.0001 @ FPR=0.0100; TPR: 0.0010 @ FPR=0.0500; TPR: 0.0031 @ FPR=0.1000
NAT vs. BIM_L2 --> auroc: 0.9903; TPR: 0.8992 @ FPR=0.0100; TPR: 0.9561 @ FPR=0.0500; TPR: 0.9730 @ FPR=0.1000
NAT vs. PGD_L2 --> auroc: 0.9510; TPR: 0.5988 @ FPR=0.0100; TPR: 0.7826 @ FPR=0.0500; TPR: 0.8536 @ FPR=0.1000
NAT vs. CW_transferred from resnet152 --> auroc: 0.2170; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0000 @ FPR=0.0500; TPR: 0.0001 @ FPR=0.1000
NAT vs. PGD_transferred from resnet152 --> auroc: 0.2462; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0001 @ FPR=0.0500; TPR: 0.0002 @ FPR=0.1000
NAT vs. MIM_transferred from resnet152 --> auroc: 0.2690; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0008 @ FPR=0.0500; TPR: 0.0027 @ FPR=0.1000
NAT vs. TIM_transferred from resnet152 --> auroc: 0.5463; TPR: 0.0011 @ FPR=0.0100; TPR: 0.0145 @ FPR=0.0500; TPR: 0.0456 @ FPR=0.1000
NAT vs. DI_MIM_transferred from resnet152 --> auroc: 0.1145; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0000 @ FPR=0.0500; TPR: 0.0000 @ FPR=0.1000
NAT vs. spsa --> auroc: 0.2274; TPR: 0.0002 @ FPR=0.0100; TPR: 0.0026 @ FPR=0.0500; TPR: 0.0082 @ FPR=0.1000

abl--batchwise sample
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id emp-nores-nou-6epoch-batchwise --posterior_type emp --blur_prob 0.03 --epochs 6 --epsilon_min_train 0.5 --alpha 0 --batchwise_sample
Parallel ensemble 20 TOP1: 76.0860, TOP5: 92.9860, LOS: 1.0078, ECE: 0.0616
NAT vs. FGSM --> auroc: 0.0606; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0000 @ FPR=0.0500; TPR: 0.0000 @ FPR=0.1000
NAT vs. CW --> auroc: 0.7222; TPR: 0.1411 @ FPR=0.0100; TPR: 0.2716 @ FPR=0.0500; TPR: 0.3676 @ FPR=0.1000
NAT vs. BIM --> auroc: 0.9873; TPR: 0.8671 @ FPR=0.0100; TPR: 0.9413 @ FPR=0.0500; TPR: 0.9645 @ FPR=0.1000
NAT vs. PGD --> auroc: 0.9590; TPR: 0.6502 @ FPR=0.0100; TPR: 0.8126 @ FPR=0.0500; TPR: 0.8794 @ FPR=0.1000
NAT vs. MIM --> auroc: 0.9915; TPR: 0.8731 @ FPR=0.0100; TPR: 0.9562 @ FPR=0.0500; TPR: 0.9783 @ FPR=0.1000
NAT vs. TIM --> auroc: 0.9929; TPR: 0.8806 @ FPR=0.0100; TPR: 0.9643 @ FPR=0.0500; TPR: 0.9839 @ FPR=0.1000
NAT vs. DI_MIM --> auroc: 0.0641; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0000 @ FPR=0.0500; TPR: 0.0000 @ FPR=0.1000
NAT vs. FGSM_L2 --> auroc: 0.2737; TPR: 0.0001 @ FPR=0.0100; TPR: 0.0009 @ FPR=0.0500; TPR: 0.0034 @ FPR=0.1000
NAT vs. BIM_L2 --> auroc: 0.9911; TPR: 0.9019 @ FPR=0.0100; TPR: 0.9587 @ FPR=0.0500; TPR: 0.9763 @ FPR=0.1000
NAT vs. PGD_L2 --> auroc: 0.9537; TPR: 0.6221 @ FPR=0.0100; TPR: 0.7961 @ FPR=0.0500; TPR: 0.8652 @ FPR=0.1000
NAT vs. CW_transferred from resnet152 --> auroc: 0.1818; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0000 @ FPR=0.0500; TPR: 0.0003 @ FPR=0.1000
NAT vs. PGD_transferred from resnet152 --> auroc: 0.2193; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0001 @ FPR=0.0500; TPR: 0.0004 @ FPR=0.1000
NAT vs. MIM_transferred from resnet152 --> auroc: 0.2431; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0010 @ FPR=0.0500; TPR: 0.0034 @ FPR=0.1000
NAT vs. TIM_transferred from resnet152 --> auroc: 0.5355; TPR: 0.0012 @ FPR=0.0100; TPR: 0.0149 @ FPR=0.0500; TPR: 0.0455 @ FPR=0.1000
NAT vs. DI_MIM_transferred from resnet152 --> auroc: 0.0527; TPR: 0.0000 @ FPR=0.0100; TPR: 0.0000 @ FPR=0.0500; TPR: 0.0000 @ FPR=0.1000
NAT vs. spsa --> auroc: 0.2282; TPR: 0.0005 @ FPR=0.0100; TPR: 0.0028 @ FPR=0.0500; TPR: 0.0063 @ FPR=0.1000

-----------face------------
origin softmax
Parallel ensemble 20 vgg2_fp: 0.9256
Parallel ensemble 20 lfw: 0.9913
Parallel ensemble 20 agedb_30: 0.9177
Parallel ensemble 20 lfw: 0.9913
Parallel ensemble 20 calfw: 0.9107
Parallel ensemble 20 cplfw: 0.8630
Parallel ensemble 20 cfp_ff: 0.9873
Parallel ensemble 20 cfp_fp: 0.9523

#########
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_face.py --job-id face_ir50_softmax-alpha100 --posterior_type emp --data_path /data/zhijie/faces_emore --epsilon_min_train 1 --epsilon_max_train 2 --blur_prob 0 --uncertainty_threshold 1 --arch IR_50 --head Softmax --alpha 100  (gpu16 or gpu35)
Parallel ensemble 20 vgg2_fp: 0.9246
Parallel ensemble 20 lfw: 0.9892
Parallel ensemble 20 lfw: 0.9892
Parallel ensemble 20 cplfw: 0.8598
Parallel ensemble 20 calfw: 0.9120
Parallel ensemble 20 agedb_30: 0.9167
Parallel ensemble 20 cfp_fp: 0.9489
Parallel ensemble 20 cfp_ff: 0.9874

# abl study
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_face.py --job-id face_ir50_softmax-alpha0 --posterior_type emp --data_path /data/zhijie/faces_emore --epsilon_min_train 1 --epsilon_max_train 2 --blur_prob 0 --uncertainty_threshold 1 --arch IR_50 --head Softmax --alpha 0
Parallel ensemble 20 vgg2_fp: 0.9224
Parallel ensemble 20 lfw: 0.9890
Parallel ensemble 20 calfw: 0.9115
Parallel ensemble 20 cplfw: 0.8603
Parallel ensemble 20 agedb_30: 0.9125
Parallel ensemble 20 cfp_fp: 0.9479
Parallel ensemble 20 cfp_ff: 0.9859
Parallel ensemble 20 lfw: 0.9890


CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_face.py --job-id face_ir50_softmax-alpha30 --posterior_type emp --epsilon_min_train 1 --epsilon_max_train 2 --blur_prob 0 --uncertainty_threshold 1 --arch IR_50 --head Softmax --alpha 30 (gpu35)
Parallel ensemble 20 vgg2_fp: 0.9236
Parallel ensemble 20 agedb_30: 0.9138
Parallel ensemble 20 lfw: 0.9903
Parallel ensemble 20 calfw: 0.9135
Parallel ensemble 20 cplfw: 0.8627
Parallel ensemble 20 lfw: 0.9903
Parallel ensemble 20 cfp_ff: 0.9864
Parallel ensemble 20 cfp_fp: 0.9479

CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_face.py --job-id face_ir50_softmax-alpha100-6epochs --posterior_type emp --epsilon_min_train 1 --epsilon_max_train 2 --blur_prob 0 --uncertainty_threshold 1 --arch IR_50 --head Softmax --alpha 100 --epochs 6 (gpu35)
Parallel ensemble 20 vgg2_fp: 0.9260
Parallel ensemble 20 agedb_30: 0.9138
Parallel ensemble 20 lfw: 0.9898
Parallel ensemble 20 lfw: 0.9898
Parallel ensemble 20 calfw: 0.9132
Parallel ensemble 20 cplfw: 0.8607
Parallel ensemble 20 cfp_fp: 0.9483
Parallel ensemble 20 cfp_ff: 0.9867


origin cosface
Parallel ensemble 20 vgg2_fp: 0.9370
Parallel ensemble 20 cplfw: 0.8915
Parallel ensemble 20 lfw: 0.9930
Parallel ensemble 20 calfw: 0.9327
Parallel ensemble 20 lfw: 0.9930
Parallel ensemble 20 agedb_30: 0.9435
Parallel ensemble 20 cfp_fp: 0.9564
Parallel ensemble 20 cfp_ff: 0.9927

#########
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_face.py --job-id face_ir50_cos-alpha100 --posterior_type emp --data_path /data/zhijie/faces_emore --epsilon_min_train 1 --epsilon_max_train 2 --blur_prob 0 --uncertainty_threshold 1 --arch IR_50 --head CosFace --alpha 100 (gpu16)
Parallel ensemble 20 vgg2_fp: 0.9376
Parallel ensemble 20 lfw: 0.9935
Parallel ensemble 20 lfw: 0.9935
Parallel ensemble 20 calfw: 0.9352
Parallel ensemble 20 cplfw: 0.8910
Parallel ensemble 20 agedb_30: 0.9433
Parallel ensemble 20 cfp_ff: 0.9927
Parallel ensemble 20 cfp_fp: 0.9597

abl
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_face.py --job-id face_ir50_cos-alpha0 --posterior_type emp --data_path /data/zhijie/faces_emore --epsilon_min_train 1 --epsilon_max_train 2 --blur_prob 0 --uncertainty_threshold 1 --arch IR_50 --head CosFace --alpha 0
Parallel ensemble 20 vgg2_fp: 0.9348
Parallel ensemble 20 lfw: 0.9923
Parallel ensemble 20 lfw: 0.9923
Parallel ensemble 20 calfw: 0.9312
Parallel ensemble 20 agedb_30: 0.9420
Parallel ensemble 20 cplfw: 0.8903
Parallel ensemble 20 cfp_fp: 0.9537
Parallel ensemble 20 cfp_ff: 0.9921


CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_face.py --job-id face_ir50_cos-alpha100-6epoch --posterior_type emp --data_path /data/zhijie/faces_emore --epsilon_min_train 1 --epsilon_max_train 2 --blur_prob 0 --uncertainty_threshold 1 --arch IR_50 --head CosFace --alpha 100 --epochs 6 (gpu16)
Parallel ensemble 20 vgg2_fp: 0.9366
Parallel ensemble 20 cplfw: 0.8927
Parallel ensemble 20 lfw: 0.9930
Parallel ensemble 20 lfw: 0.9930
Parallel ensemble 20 calfw: 0.9357
Parallel ensemble 20 agedb_30: 0.9427
Parallel ensemble 20 cfp_fp: 0.9603
Parallel ensemble 20 cfp_ff: 0.9914


arcface origin
Parallel ensemble 20 vgg2_fp: 0.9356
Parallel ensemble 20 lfw: 0.9933
Parallel ensemble 20 cplfw: 0.8808
Parallel ensemble 20 lfw: 0.9933
Parallel ensemble 20 calfw: 0.9292
Parallel ensemble 20 agedb_30: 0.9327
Parallel ensemble 20 cfp_ff: 0.9914
Parallel ensemble 20 cfp_fp: 0.9587


CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_face.py --job-id face_ir50_arc-alpha100 --posterior_type emp --data_path /data/zhijie/faces_emore --epsilon_min_train 1 --epsilon_max_train 2 --blur_prob 0 --uncertainty_threshold 1 --arch IR_50 --head ArcFace --alpha 100 (gpu16)
Parallel ensemble 20 vgg2_fp: 0.9348
Parallel ensemble 20 lfw: 0.9943
Parallel ensemble 20 cplfw: 0.8837
Parallel ensemble 20 agedb_30: 0.9337
Parallel ensemble 20 lfw: 0.9943
Parallel ensemble 20 calfw: 0.9283
Parallel ensemble 20 cfp_fp: 0.9573
Parallel ensemble 20 cfp_ff: 0.9921

abl
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_face.py --job-id face_ir50_arc-alpha0 --posterior_type emp --data_path /data/zhijie/faces_emore --epsilon_min_train 1 --epsilon_max_train 2 --blur_prob 0 --uncertainty_threshold 1 --arch IR_50 --head ArcFace --alpha 0
Parallel ensemble 20 vgg2_fp: 0.9328
Parallel ensemble 20 lfw: 0.9940
Parallel ensemble 20 lfw: 0.9940
Parallel ensemble 20 agedb_30: 0.9335
Parallel ensemble 20 calfw: 0.9275
Parallel ensemble 20 cplfw: 0.8828
Parallel ensemble 20 cfp_ff: 0.9911
Parallel ensemble 20 cfp_fp: 0.9577


------------------coco detection-----------------------
DNN
# Class      Images     Targets           P           R      mAP@.5  mAP@.5:.95
# all       5e+03    3.63e+04       0.365       0.649       0.559       0.357


python train.py --data coco.yaml --cfg yolov5s.yaml --weights yolov5s.pt --batch-size 64  --lr 0.0005 --ft_lr 0.00005 --alpha 0.0  --epochs 4 (gpu16: exp100)
0.337       0.661       0.556       0.353
NAT vs. bim --> auroc: 0.9965; TPR: 0.9374 @ FPR=0.0100; TPR: 0.9942 @ FPR=0.0500; TPR: 0.9982 @ FPR=0.1000
NAT vs. mim --> auroc: 0.9967; TPR: 0.9466 @ FPR=0.0100; TPR: 0.9940 @ FPR=0.0500; TPR: 0.9988 @ FPR=0.1000
NAT vs. pgd --> auroc: 0.9966; TPR: 0.9432 @ FPR=0.0100; TPR: 0.9952 @ FPR=0.0500; TPR: 0.9990 @ FPR=0.1000


python train.py --data coco.yaml --cfg yolov5s.yaml --weights yolov5s.pt --batch-size 32  --lr 0.0005 --ft_lr 0.00005 --alpha 0.02  --epochs 4 (gpu16: exp110)
0.316       0.657       0.546       0.344
NAT vs. fgsm --> auroc: 0.8105; TPR: 0.0750 @ FPR=0.0100; TPR: 0.2538 @ FPR=0.0500; TPR: 0.4132 @ FPR=0.1000
NAT vs. bim --> auroc: 0.9813; TPR: 0.6470 @ FPR=0.0100; TPR: 0.9054 @ FPR=0.0500; TPR: 0.9628 @ FPR=0.1000
NAT vs. mim --> auroc: 0.9876; TPR: 0.7544 @ FPR=0.0100; TPR: 0.9428 @ FPR=0.0500; TPR: 0.9786 @ FPR=0.1000
NAT vs. bim --> auroc: 0.9810; TPR: 0.6496 @ FPR=0.0100; TPR: 0.8990 @ FPR=0.0500; TPR: 0.9616 @ FPR=0.1000





mc dropout with output mutual information
CUDA_VISIBLE_DEVICES=0,6 python mc_dropout.py --batch_size 128 --attack_methods PGD --unc_metric mi --job-id tmp
NAT vs. PGD --> auroc: 0.0438; TPR: 0.0001 @ FPR=0.0100; TPR: 0.0004 @ FPR=0.0500; TPR: 0.0010 @ FPR=0.1000


mc dropout:
CUDA_VISIBLE_DEVICES=0,5,7 python mc_dropout.py --job-id mc_dropout --batch_size 96
Parallel ensemble 20 TOP1: 74.8160, TOP5: 92.2460, LOS: 0.9922
NAT vs. FGSM --> auroc: 0.6068; TPR: 0.0144 @ FPR=0.0100; TPR: 0.0846 @ FPR=0.0500; TPR: 0.1697 @ FPR=0.1000  50001-50001
NAT vs. CW --> auroc: 0.9799; TPR: 0.7749 @ FPR=0.0100; TPR: 0.9062 @ FPR=0.0500; TPR: 0.9457 @ FPR=0.1000  50001-50001
NAT vs. BIM --> auroc: 1.0000; TPR: 0.9999 @ FPR=0.0100; TPR: 1.0000 @ FPR=0.0500; TPR: 1.0000 @ FPR=0.1000  50001-50001


mfg:
CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 python finetune_imagenet.py --job-id mfg-full-blur.03-6epoch-mineps.5 --posterior_type mfg --blur_prob 0.03 --epochs 6 --epsilon_min_train 0.5 --full --resume auto --evaluate --batch_size 128
Parallel ensemble 20 TOP1: 76.0320, TOP5: 92.9620, LOS: 0.9500, ECE: 0.0203
NAT vs. FGSM --> auroc: 0.9867; TPR: 0.6268 @ FPR=0.0100; TPR: 0.9650 @ FPR=0.0500; TPR: 0.9886 @ FPR=0.1000  50000-50000
NAT vs. CW --> auroc: 0.9427; TPR: 0.4998 @ FPR=0.0100; TPR: 0.7512 @ FPR=0.0500; TPR: 0.8474 @ FPR=0.1000  50000-50000
NAT vs. BIM --> auroc: 0.9999; TPR: 0.9990 @ FPR=0.0100; TPR: 0.9998 @ FPR=0.0500; TPR: 0.9999 @ FPR=0.1000  50000-50000
